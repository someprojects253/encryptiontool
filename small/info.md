Smaller cleaned up version. No chaining, no unauthenticated modes, no custom Encrypt-then-MAC scheme for unauthenticated modes. Significantly fewer lines of code.
